<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<link rel="stylesheet" type="text/css" href="Css/Css_Final.css">
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/icon?family=Material+Icons">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
</head>

<body>
    <header>
        <h1>Ninja-Gaming
            <br>Dein Shop fürs Ausleiehen und Kaufen von Games
        </h1>
        <img id ="titelbild" src="Bilder/Ninja.png" alt="Ninja">
    </header>

    <div id="nav">
		<a href="index.html"> Startseite</a>
		<a href="spielauswahl.html?spielplattformId=2"> PC</a>
		<a href="spielauswahl.html?spielplattformId=1"> PS4</a>
		<a href="spielauswahl.html?spielplattformId=3"> XBOX</a>
		<a href="impressum.html"> Impressum</a>
		<a href="kontakt.html">Kontakt</a>
    </div>
   
    <a href="warenkorb.html"><img id="Warenkorb" src="Bilder/Warenkorb.png" alt="Warenkorb"/></a>

    <h2 id="plattform"></h2>

    <select name="Sortiere nach" id ="sortierung">
        <option value="" disabled selected>Sortiere nach:</option>
        <option value="PreisAuf">Preis: Aufsteigend</option>
        <option value="PreisAB">Preis: Absteigend</option>
        <option value="ErscheinungsdatumAuf">Erscheinungsjahr: Aufsteigend</option>
        <option value="ErscheinungsdatumAb">Erscheinungsjahr: Absteigend</option>
        <option value="Nur Kaufen">Nur zum Kaufen</option>
        <option value="NurLeihen">Nur zum Leihen</option>
    </select>

    <div id="SpieleContainer">
        <!-- Hier werden die Einzelnen Spiele gerendert-->
    </div>
    <footer>
            <div class="Footer_links">
                <a href="impressum.html">Impressum</a> <br><br>
                <a href="kontakt.html">Kontakt</a> <br><br>
                <a href="support.html">Support</a>
            </div>
            <div class="Footer_mitte">
                <p>Zahlungsarten:</p> <br>
                <img src="Bilder/Paypal-logo.jpg" alt="Paypal" >
                <img src="Bilder/Barzahlung_logo.png" alt="Barzahlung" >
            </div>
     
            <div class="Footer_rechts">
                <p>Soziale Netzwerke:</p>
                <a href="https://de-de.facebook.com/"><img src="Bilder/Facebook_logo.png" alt="Facebook"></a>
                <a href="https://twitter.com/?lang=de"><img src="Bilder/Twitter_logo.png" alt="Twitter"></a>
                <a href="https://www.instagram.com/"><img src="Bilder/Instagram_logo.jpg" alt="Facebook"></a>
            </div>
        </footer>
</body>
<script src="JQuery_JS/urlParameter.js"></script>
<script>
    $(document).ready(function() {
        if(!hasUrlParameters()){
            $('H2#plattform').text('Fehlerhaft');
        }
        else {
            var id = getUrlParameterValue('spielplattformId');
            $.ajax({
            url: "http://localhost:8000/api/spielplattform/alle",
            method: "GET",
            dataType: "json"
            })
            .done(function(httpResponse) {
                var list = httpResponse.daten;
                for (i = 0; i < list.length; i++) {
                    if (list[i].id == id){
                        $('H2#plattform').text('Plattform: ' + list[i].name);
                    }
                }
            })
            .fail(function(jqXHR, statusText, error) {
            console.log(statusText);
            alert("Es ist ein Fehler aufgetreten");
            })
        }
    })
  </script>
  <script>
    $(document).ready(function() {
        if(!hasUrlParameters()){
            $('H2#plattform').text('Fehlerhaft');
        }
        else {
            var id = getUrlParameterValue('spielplattformId');
            $.ajax({
            url: "http://localhost:8000/api/spiel/alle",
            method: "GET",
            dataType: "json"
            })
            .done(function(httpResponse) {
                var list = httpResponse.daten;
                var content=''
                for (i = 0; i < list.length; i++) {
                    if(list[i].spielplattform.id == id) {
                        // $('DIV#SpieleContainer').append($('<div>').addClass("spiel").text(list[i].spielname)) -- Erste "einfache" Methode gewählt, weil übersichtlicher
                        content += '<div class="spiel">';
                        content += '<a href="kaufseite.html?spielId=' + list[i].id + '"><img class="spielanzeige" src="' + list[i].bilder[0].bildpfad + '" alt="Spiel"/></a>';
                        content += '<div class="spielbeschreibung">';
                        content += '<h3>' + list[i].spielname + '</h3>';
                        content += '<h4>Genre: ' + list[i].genre.name + '</h4>';
                        content += '<h4>Erscheinungsjahr: ' + list[i].erscheinungsjahr + '</h4>';
                        content += '<p>' + list[i].beschreibung + '</p>';
                        content += '</div>';
                        content += '<div class="rechterContainer">';
                        content += '<h3>Spiel jetzt erwerben:</h3>';
                        if (list[i].kaufart.id == 1 || list[i].kaufart.id == 3) {
                            content += '<a href="kaufseite.html?spielId='+ list[i].id + '"><button class="ZumSpiel">Jetzt kaufen für ' + list[i].bruttokaufpreis+ '€</button></a>';
                        }
                        else {
                            content += '<a href="kaufseite.html?spielId='+ list[i].id + '"><button class="ZumSpiel" disabled>Jetzt kaufen für ' + list[i].bruttokaufpreis + '€</button></a>';
                        }
                        if (list[i].kaufart.id == 2 || list[i].kaufart.id == 3) {
                            content += '<a href="kaufseite.html?spielId='+ list[i].id + '"><button class="ZumSpiel" >Jetzt leihen für '+ list[i].bruttoleihpreis + '€/Tag</button></a>';
                        }
                        else {
                            content += '<a href="kaufseite.html?spielId='+ list[i].id + '"><button class="ZumSpiel" disabled>Jetzt leihen für '+ list[i].bruttoleihpreis + '€/Tag</button></a>';;
                        }
                        content += '</div>';
                        content += '</div>';
                        $('DIV#SpieleContainer').html(content);
                    }
                       
                }
            })
            .fail(function(jqXHR, statusText, error) {
            console.log(statusText);
            alert("Es ist ein Fehler aufgetreten");
            })
        }
    })
  </script>
</html>