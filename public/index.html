<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<link rel="stylesheet" type="text/css" href="Css/Css_Final.css">
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/icon?family=Material+Icons">
</head>

<body>
    <header>
        <h1>Ninja-Gaming
            <br>Dein Shop fürs Ausleiehen und Kaufen von Games
        </h1>
        <img id ="titelbild" src="Bilder/Ninja.png" alt="Ninja">
    </header>

    <div id="nav">
		<a href="index.html"> Startseite</a>
		<a href="spielauswahl.html?spielplattformId=2"> PC</a>
		<a href="spielauswahl.html?spielplattformId=1"> PS4</a>
		<a href="spielauswahl.html?spielplattformId=3"> XBOX</a>
		<a href="impressum.html"> Impressum</a>
		<a href="kontakt.html">Kontakt</a>
    </div>
    
    <div class="boxContainer">
        <table class="elementsContainer">
        <tr>
        <td>
        <input type="text" placeholder="Suche nach Spiel"
        class="search" onchange="suche(this.value)">
        </td>
        <td>
        <a href="kaufseite.html"> <i class="material-icons">search</i>
        </a>
        </td>
        </tr>
        </table>
    </div>
    <a href="warenkorb.html"><img id="Warenkorb" src="Bilder/Warenkorb.png" alt="Warenkorb"/></a>

    <div class="slideshow-container">
        <div class="mySlides fade">
            <div class="numbertext">1 / 3</div>
            <a href="kaufseite.html"><img class="slideIMG" src="Bilder/Banner1.jpg" style="width:100%" ></a>
            <div class="text"></div>
        </div>
    
        <div class="mySlides fade">
            <div class="numbertext">2 / 3</div>
            <a href="kaufseite.html"><img class="slideIMG" src="Bilder/Banner2.jpg" style="width:100%" ></a>
            <div class="text"></div>
        </div>

        <div class="mySlides fade">
            <div class="numbertext">3 / 3</div>
            <a href="kaufseite.html"><img class="slideIMG" src="Bilder/Banner3.jpg"style="width:100%"></a>
            <div class="text"></div>
        </div>

    <a class="prev" onclick="plusSlides(-1)">&#10094;</a>
    <a class="next" onclick="plusSlides(1)">&#10095;</a>
    </div>

    <div class="dots">
        <span class="dot" onclick="currentSlide(1)"></span>
        <span class="dot" onclick="currentSlide(2)"></span>
        <span class="dot" onclick="currentSlide(3)"></span>
    </div> 

    <h2>Top Games</h2>

    <div id="dyntarget" class="topgames">
    </div> 

    <footer>
        <div class="Footer_links">
            <a href="impressum.html">Impressum</a> <br><br>
            <a href="kontakt.html">Kontakt</a> <br><br>
            <a href="support.html">Support</a>
        </div>
        <div class="Footer_mitte">
            <p>Zahlungsarten:</p> <br>
            <img src="Bilder/Paypal-logo.jpg" alt="Paypal" >
            <img src="Bilder/Barzahlung_logo.png" alt="Barzahlung" >
        </div>
        <div class="Footer_rechts">
            <p>Soziale Netzwerke:</p>
            <a href="https://de-de.facebook.com/"><img src="Bilder/Facebook_logo.png" alt="Facebook"></a>
            <a href="https://twitter.com/?lang=de"><img src="Bilder/Twitter_logo.png" alt="Twitter"></a>
            <a href="https://www.instagram.com/"><img src="Bilder/Instagram_logo.jpg" alt="Facebook"></a>
        </div>
    </footer>
</body>
<script src="JQuery_JS/Script.js"></script>
<script src="JQuery_JS/urlParameter.js"></script>
<script>
    function suche(val) {
        $.ajax({
            url: "http://localhost:8000/api/spiel/alle",
            method: "GET",
            dataType: "json"
        })
        .done(function(httpResponse) {
            var list = httpResponse.daten
            var resultlist = [];
            for (var i=0; i< list.length; i++) {
                //Makes exact Searchinput like "Cyberpunk 2077 (Day-One-Edition)" possible
                if (list[i].spielname.toLowerCase() === val.toLowerCase()) {
                    resultlist.push(list[i]);
                }
                else if (list[i].spielname.toLowerCase().includes(val.toLowerCase())) {
                    resultlist.push(list[i]);
                }
            }
            // //Makes "one word" - Searchinput like "Cyberpunk" or "Borderlands" possible
            // else if (list[i].spielname.split(' ')[0].toLowerCase() == val.toLowerCase()) {
            //         resultlist.push(list[i]);
            //     }
            
            if (resultlist.length == 0) {
                alert("Keine Spiel zur Suchanfrage gefunden! Bitte erneut versuchen!");
            }
            else if (resultlist.length == 1) {
                window.location.replace("kaufseite.html?id=" + resultlist[0].id);
            }
            else {
                var ids = "";
                for (var x=0; x < resultlist.length;x++){
                    ids += resultlist[x].id  + " ";
                }
                window.location.replace("spielauswahl.html?ids=" + ids);
            }

        })
        .fail(function(jqXHR, statusText, error) {
            console.log(statusText);
            alert("Es ist ein Fehler aufgetreten");
        })
    }
</script>
<script>
    $(document).ready(function() {
        $.ajax({
            url: "http://localhost:8000/api/spiel/alle",
            method: "GET",
            dataType: "json"
        })
        .done(function(httpResponse) {
            var list = httpResponse.daten
            // Sorting list, latest games first in list
            for (var i=0; i < list.length; i++) {
                for (var j=i+1; j < list.length; j++) {
                    if (list[i].erscheinungsjahr < list[j].erscheinungsjahr) {
                        var old = list[i];
                        list[i] = list[j];
                        list[j] = old;
                    }
                }
            }
            // Grabbing the 5 latest Games, rendering HTML-Elements
            // for (i = 0; i < 5; i++) {
            //     if (i==0) {
            //         $("DIV#dyntarget").append(
            //             $("<div>")
<<<<<<< HEAD
            //                 .addClass("elementmittig")
=======
            //                 .addClass("randelement")
>>>>>>> 3d162119975fc18f5403b502f7b950d3897d60b0
            //                 .append($("<a>").attr("href","kaufseite.html?spielId="+list[i].id).append($("<img>").attr("src",list[i].bilder[0].bildpfad)))
            //                 .append($("<div>").addClass("PreisBeschreibungContainer").append($("<p>").addClass("Plattform").text("Plattform: ").append($("<strong>").text(list[i].spielplattform.name))).append($("<p>").addClass("Preis").text(list[i].bruttokaufpreis + "€" )).append($("<p>").addClass("Spielname").text(list[i].spielname)))
            //                 .append($("<div>").addClass("AnsehenContainer").append($("<a>").attr("href","kaufseite.html?spielId="+list[i].id).append($("<button>").addClass("ZumSpiel").text("Spiel ansehen"))))
            //         );
            //     }
            //     else if (i==4) {
            //         $("DIV#dyntarget").append(
            //             $("<div>")
<<<<<<< HEAD
            //                 .addClass("elementmittig")
=======
            //                 .addClass("randelementR")
>>>>>>> 3d162119975fc18f5403b502f7b950d3897d60b0
            //                 .append($("<a>").attr("href","kaufseite.html?spielId=" + list[i].id).append($("<img>").attr("src",list[i].bilder[0].bildpfad)))
            //                 .append($("<div>").addClass("PreisBeschreibungContainer").append($("<p>").addClass("Plattform").text("Plattform: ").append($("<strong>").text(list[i].spielplattform.name))).append($("<p>").addClass("Preis").text(list[i].bruttokaufpreis + "€" )).append($("<p>").addClass("Spielname").text(list[i].spielname)))
            //                 .append($("<div>").addClass("AnsehenContainer").append($("<a>").attr("href","kaufseite.html?spielId"+list[i].id).append($("<button>").addClass("ZumSpiel").text("Spiel ansehen")))));
            //     }
            //     else {
            //         $("DIV#dyntarget").append(
            //             $("<div>")
            //                 .addClass("elementmittig")
            //                 .append($("<a>").attr("href","kaufseite.html?spielId=" + list[i].id).append($("<img>").attr("src",list[i].bilder[0].bildpfad)))
            //                 .append($("<div>").addClass("PreisBeschreibungContainer").append($("<p>").addClass("Plattform").text("Plattform: ").append($("<strong>").text(list[i].spielplattform.name))).append($("<p>").addClass("Preis").text(list[i].bruttokaufpreis + "€" )).append($("<p>").addClass("Spielname").text(list[i].spielname)))
            //                 .append($("<div>").addClass("AnsehenContainer").append($("<a>").attr("href","kaufseite.html?spielId="+list[i].id).append($("<button>").addClass("ZumSpiel").text("Spiel ansehen")))));
            //     }
            // }
<<<<<<< HEAD
            
            // new Try
=======

>>>>>>> 3d162119975fc18f5403b502f7b950d3897d60b0
            for (var i=0; i < 5; i++) {
                $("DIV#dyntarget").append(
                    $("<div>")
                        .addClass("elementmittig")
                        .append($("<a>").attr("href","kaufseite.html?spielId=" + list[i].id).append($("<img>").attr("src",list[i].bilder[0].bildpfad)))
                        .append($("<div>").addClass("PreisBeschreibungContainer").append($("<p>").addClass("Plattform").text("Plattform: ").append($("<strong>").text(list[i].spielplattform.name))).append($("<p>").addClass("Preis").text(list[i].bruttokaufpreis + "€" )).append($("<p>").addClass("Spielname").text(list[i].spielname)))
                        .append($("<div>").addClass("AnsehenContainer").append($("<a>").attr("href","kaufseite.html?spielId="+list[i].id).append($("<button>").addClass("ZumSpiel").text("Spiel ansehen")))));
<<<<<<< HEAD
                
=======
>>>>>>> 3d162119975fc18f5403b502f7b950d3897d60b0
            }
        })
        .fail(function(jqXHR, statusText, error) {
            console.log(statusText);
            alert("Es ist ein Fehler aufgetreten");
        })
});
</script>
</html>