<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<link rel="stylesheet" type="text/css" href="Css/Css_Final.css">
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/icon?family=Material+Icons">
</head>

<body>
    <header></header>

    <div id="nav"></div>
    <!--dynamisierung Mert?..-->
    <a href="warenkorb.html"><img id="Warenkorb" src="Bilder/Warenkorb.png" alt="Warenkorb"/></a>
    <div class="kasse">
    <br><br><h2>Kasse</h2><br><br>
    </div> <br><br>
      <br><br>  <div class="left_side"> <br><br>
        
        <br><br> <b><p>   Zwischensumme    </p>
                    <p>  + Mehrwertsteuer</p> 
                 <hr> 
                <p>  = Gesamtsumme</p> </b>
                    </div>
    <div class="right_side"> <br><br>
        
        <br><br><b><p> 49,99€</p>
                <p>9,49€</p> <br>
            <div class="summe">
            <p>59,48€</p> </div></b> 
    </div>  
     <div class="lala"><br> <br><br><br><br> <br><br>
        <br><br><br> <br><br> <br> <h3>Kontaktdaten</h3>
         <p>Bitte geben Sie hier Ihre Zahlungsart und Kontaktdaten ein</p>
    
    
    </div> 
   
                <div class="kasten_container"> 
                    <div class="select-box"> <br> <br>
                        <select class ="inputKlasse">
                            <option disabled selected>Zahlungsart auswählen</option>
                            <option>PayPal</option>
                            <option>Barzahlung</option>
                        </select>
             </div>
    
    
             <br><br> <div class="container1"> <br><br><br> 
                
                <input type="text" class ="inputKlasse" id="fname" name="firstname" placeholder="Vorname">
                <input type="text" class ="inputKlasse" id="nname" name="lastname" placeholder="Nachname">
                <input type="text" class ="inputKlasse" id="email" name="email" placeholder="Email">
                    <input type="number" class ="inputKlasse" id="mobilnummer" name="mobilnummer" placeholder="Mobilnummer">           

            
                    <div class="zahlbutton">
           <br>  <a ><button class="ZumSpiel" id="zumSpiel">
                        Bezahlen
                        </button></a>
                    </div>

        <br><br>
    </div>          
    
    <br><br>
    
    <footer></footer>

</body>
<!-- Eingebundene Scripts: -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script src="JQuery_JS/Sortierung.js"></script>
<script src="JQuery_JS/Script.js"></script>
<script src="JQuery_JS/urlParameter.js"></script>
<script>
    //Erstellung Header
    createHeader();
    // Erstellung des Navs
    createNav();
    // Erstellung des Footers
    createFooter();

    // onclick="bestellErstellung()"

    $("#zumSpiel").click(function() { 
        console.log("button zumSpiel clicked");
        const vorname = document.getElementById("fname").value;
        const nachname = document.getElementById("nname").value;
        const mobilnummer = document.getElementById("mobilnummer").value;
        const email = document.getElementById("email").value;

        var obj = { "vorname": vorname, "nachname": nachname, "mobilnummer" : mobilnummer, "email" : email };

        console.log(obj);
        console.log(JSON.stringify(obj));
		$.ajax({
            url: "http://localhost:8000/api/person/existiert/" + vorname + "/" + nachname + "/" + mobilnummer + "/" + email,
            method: "get",
            dataType: "json"
            })
            .done(function(httpResponse) {
                var erg = httpResponse.daten;
                if (erg.existiert) {
                    alert("User existiert schon.");
                }
                else {
                    $.ajax({
                        url: "http://localhost:8000/api/person",
                        method: "post",
				        contentType: "application/json",
				        data: JSON.stringify(obj)
                        })
                        .done(function (response) {
                            console.log(response);
                            })
                        .fail(function (jqXHR, statusText, error) {
                        console.log("Response Code: " + jqXHR.status + " - Fehlermeldung: " + jqXHR.responseText);
                        });
                    }
            })
            .fail(function(jqXHR, statusText, error) {
            console.log(statusText);
            alert("Es ist ein Fehler aufgetreten");
            })
            });
</script>
</html>